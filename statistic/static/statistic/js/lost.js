// Generated by CoffeeScript 1.10.0
(function() {
  var Cell, Column, LostPageHeader, LostTable, Table, a, div, h3, ref, tableRowClick;

  ref = React.DOM, a = ref.a, h3 = ref.h3, div = ref.div;

  Table = React.createFactory(FixedDataTable.Table);

  Column = React.createFactory(FixedDataTable.Column);

  Cell = React.createFactory(FixedDataTable.Cell);

  LostPageHeader = React.createFactory(React.createClass({
    render: function() {
      return div({}, [h3({}, "首次使用时间:" + this.props.date), div({}, "总流失: " + this.props.ratio['total']), div({}, "全失败: " + this.props.ratio["all_fail"] + ", " + (this.props.ratio['all_fail'] / this.props.ratio['total'] * 100) + "%"), div({}, "全成功: " + this.props.ratio['all_success'] + ", " + (this.props.ratio['all_success'] / this.props.ratio['total'] * 100) + "%"), div({}, "全失败中试过QQ/163/126: " + this.props.ratio['all_fail_qq_163'] + ", " + (this.props.ratio['all_fail_qq_163'] / this.props.ratio['all_fail'] * 100) + "%"), div({}, "全成功且只有一个邮箱: " + this.props.ratio['all_success_and_single_mailbox_count'] + ", " + (this.props.ratio['all_success_and_single_mailbox_count'] / this.props.ratio['all_success'] * 100) + "%")]);
    }
  }));

  tableRowClick = function(props) {
    var k, results, s, v;
    results = [];
    for (k in props) {
      v = props[k];
      results.push(s = k);
    }
    return results;
  };

  LostTable = React.createFactory(React.createClass({
    render: function() {
      var all_fail, data, ref1, user;
      data = [];
      ref1 = this.props.lost;
      for (user in ref1) {
        all_fail = ref1[user];
        data.push({
          user: user,
          'all_fail': all_fail,
          'emails': this.props.emails[user]
        });
      }
      return Table({
        rowHeight: 50,
        headerHeight: 50,
        rowsCount: data.length,
        width: 1000,
        height: 500
      }, [
        Column({
          width: 150,
          header: Cell({}, "IMEI (共" + this.props.ratio.total + "人)"),
          cell: (function(props) {
            return Cell(props, data[props.rowIndex]['user']);
          })
        }), Column({
          width: 100,
          header: Cell({}, "成功添加的邮箱(" + this.props.ratio.all_fail + ", " + (this.props.ratio.all_fail / this.props.ratio.total * 100) + "%"),
          cell: (function(props) {
            return Cell(props, data[props.rowIndex]['all_fail'] ? '全失败' : '部分失败');
          })
        }), Column({
          width: 750,
          header: Cell({}, 'emails'),
          cell: (function(props) {
            return Cell(props, JSON.stringify(data[props.rowIndex]['emails']));
          })
        })
      ]);
    }
  }));

  $(function() {
    return $.getJSON(url, {
      date: date,
      interval_unit: interval_unit
    }, function(response) {
      ReactDOM.render(LostPageHeader({
        ratio: response.ratio,
        date: date
      }), document.getElementById("header"));
      return ReactDOM.render(LostTable({
        lost: response.lost,
        emails: response.user_emails,
        ratio: response.ratio
      }), document.getElementById("content"));
    });
  });

}).call(this);

//# sourceMappingURL=lost.js.map
